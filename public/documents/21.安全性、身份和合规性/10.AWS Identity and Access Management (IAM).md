## AWS Identity and Access Management (IAM)

**AWS Identity and Access Management (IAM)** 是 AWS 提供的一项服务，帮助用户安全地控制对 AWS 服务和资源的访问。通过 IAM，您可以管理 AWS 服务和资源的用户、组和角色，并控制这些实体对资源的访问权限。

### 核心功能

1. **身份管理**：
   - IAM 允许用户创建和管理 AWS 账户下的用户（用户可以是个人、应用程序或其他服务）。每个用户拥有一组唯一的凭证，如访问密钥或密码，来执行操作。

2. **基于角色的访问控制 (RBAC)**：
   - IAM 提供基于角色的访问控制功能，用户可以为用户、组和角色分配精细化的权限策略。通过策略，您可以定义允许或拒绝哪些 AWS 资源或操作。

3. **IAM 用户**：
   - 每个 IAM 用户都是唯一的，并且可以分配不同的访问权限。用户可以通过访问密钥、密码或 MFA（多重身份验证）来访问 AWS 资源。

4. **IAM 组**：
   - 组允许用户被组织成逻辑组，权限可以被集体分配给组内的所有用户。这样可以简化对多个用户的权限管理。

5. **IAM 角色**：
   - 角色是一种没有凭证的身份，通常用于授予 AWS 资源访问权限，允许 AWS 服务（如 EC2 实例）或其他 AWS 账户的用户访问资源。角色通过临时安全凭证为实体提供访问 AWS 资源的能力。

6. **IAM 策略**：
   - IAM 策略定义了允许或拒绝特定 AWS 资源和操作的访问控制规则。它们可以被分配给用户、组或角色。IAM 支持 JSON 格式的策略文档，用户可以自定义策略来精细控制访问权限。

7. **权限边界**：
   - 权限边界是一种高级功能，它允许用户设置 IAM 角色或 IAM 用户的最大权限。这确保了即使分配了过多的权限，权限边界仍然会限制用户或角色的最大权限范围。

8. **多重身份验证 (MFA)**：
   - IAM 支持多重身份验证（MFA），为用户提供额外的安全层。启用 MFA 后，用户在访问 AWS 资源时不仅需要输入用户名和密码，还需要提供额外的身份验证因素（如虚拟 MFA 设备或硬件 MFA 设备生成的临时代码）。

9. **跨账户访问和身份联合**：
   - IAM 支持跨账户访问，允许一个 AWS 账户的用户和角色访问另一个 AWS 账户的资源。此外，IAM 还支持身份联合，可以将外部身份提供者（如企业目录或社交登录服务）与 AWS 集成，使外部用户能够通过现有的身份验证机制访问 AWS 资源。

10. **服务控制策略 (SCP)**：
    - SCP 是 AWS Organizations 的一部分，用于在组织范围内限制所有账户的权限。它可以定义允许或拒绝的操作范围，从而增强对多个账户的访问控制。

### 使用场景

1. **访问控制**：
   - 使用 IAM，您可以为不同的用户和应用程序定义访问权限。通过精细的策略，可以确保用户只能访问他们工作所需的最少 AWS 资源。

2. **跨账户访问**：
   - 在多账户架构中，IAM 可以用于设置跨账户访问权限。通过角色信任策略，允许某个账户的 IAM 角色被其他 AWS 账户的用户或服务使用。

3. **多重身份验证 (MFA)**：
   - 为了增强账户安全性，IAM 可以为重要用户（如 root 用户）启用 MFA，确保即使凭证泄露，攻击者也无法轻易访问账户。

4. **临时安全凭证**：
   - IAM 角色提供临时凭证，特别适用于需要临时访问权限的服务或用户，减少长期凭证暴露的风险。常用于 EC2 实例或 Lambda 函数执行时授权访问其他 AWS 资源。

5. **外部身份联合**：
   - IAM 支持将外部身份提供者（如 SAML、OpenID Connect）集成到 AWS 中，实现基于现有身份系统的单点登录（SSO）解决方案，减少用户管理复杂性。

6. **权限边界**：
   - 权限边界可以确保即使 IAM 用户或角色被意外授予过多权限，他们的权限仍然受到严格控制，防止未经授权的操作。

### 安全最佳实践

1. **最小权限原则**：
   - 只为用户和服务分配他们所需的最小权限，确保即使凭证泄露，造成的损害也最小。

2. **启用 MFA**：
   - 为所有重要用户启用 MFA，尤其是 root 用户账户，增加安全保障。

3. **定期轮换密钥和密码**：
   - 定期更新和轮换 IAM 用户的访问密钥和密码，避免长期使用同一凭证导致的安全风险。

4. **使用角色而非根账户**：
   - 始终避免使用根账户进行日常操作，而是通过 IAM 角色授予所需权限，并仅在必要时使用根账户。

5. **使用 IAM Access Analyzer**：
   - IAM Access Analyzer 可以帮助用户识别不必要的外部访问，并确保策略配置符合预期的安全要求。

### 定价

IAM 服务本身没有额外的费用。用户可以免费创建和管理 IAM 用户、组、角色和策略。用户只需为与 IAM 相关的 AWS 服务（如 EC2、S3）或高级功能（如 AWS Organizations、GuardDuty）的使用支付费用。

### 总结

AWS Identity and Access Management (IAM) 是控制 AWS 环境中访问权限的核心服务。通过 IAM，用户可以管理用户、组和角色，定义精细化的权限策略，启用多重身份验证，并支持跨账户访问和外部身份联合。它确保用户和应用程序只能访问他们被授权的 AWS 资源，从而提升 AWS 账户和资源的安全性。